<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://www.oasis-open.org/docbook/4.5" xmlns:xl="http://www.w3.org/1999/xlink"
         xsi:schemaLocation="http://www.oasis-open.org/docbook/4.5 http://www.oasis-open.org/docbook/xsd/4.5/docbook.xsd">

    <title>
        Express Data Prep Wizard
        <inlinemediaobject>
            <imageobject>
                <imagedata fileref="notice_commercial_editions_only.png"
                           format="PNG"/>
            </imageobject>
        </inlinemediaobject>
    </title>
    <chapterinfo>
        <abstract>
            <para>
                Express Data Prep Wizard is a tool available in Commercial Editions that helps
                customers to process their postal data faster and more efficiently.
            </para>
        </abstract>
    </chapterinfo>

    <section id="edp_wizard_context">
        <title>Context</title>
        <para>
            Use this wizard on yours or your client's customer lists to develop an automated data processing
            solution to optimize data, improve contact, remove waste as well as (optionally) secure postal
            discounts for more effective customer communications.
        </para>

        <mediaobject>
            <imageobject>
                <imagedata fileref="edp-wizard-welcome-page.png" format="PNG" scalefit="1"/>
            </imageobject>
        </mediaobject>

        <para>
            The wizard <quote>How can I effectively communicate with customers</quote> walks you through the necessary
            configuration that is used to create a data-cleansing job which can be uploaded to DataCleaner Monitor.
            Hot folder functionality allows you to continuously upload new raw data which triggers the job execution.
            The results are automatically put to the predefined directory. Among other things you can find there final
            <emphasis>cleansed</emphasis> and <emphasis>invalid data</emphasis> and a PDF report containing
            financial summary there.
        </para>

        <emphasis>Available services</emphasis>
        <para>
            <itemizedlist mark='services'>
                <listitem><para>Name Cleansing</para></listitem>
                <listitem><para>Address Correction</para></listitem>
                <listitem><para>Email Correction</para></listitem>
                <listitem><para>Phone Correction</para></listitem>
                <listitem><para>Sorting</para></listitem>
            </itemizedlist>
        </para>
    </section>

    <section id="edp_wizard_installation">
        <title>Installation</title>
        <para>
            During a typical DataCleaner Enterprise installation remember to check
            <emphasis>Express Data Prep</emphasis>.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-install-02.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
            This option is enabled after you have selected <emphasis>Name and Address correction (on premise)</emphasis>
            item.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-install-01.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>

            Proceed with the installation and run DataCleaner Desktop. Express Data Prep Wizard should be available
            on the welcome page.
        </para>
    </section>

    <section id="edp_wizard_configuration">
        <title>Configuration</title>
        <para>
            The Express Data Prep Wizard requires a few inputs from the user. Some values can be pre-defined so that
            they can be automatically put to the particular fields in the UI. This is achieved through a standard java
            properties file.
        </para>

        <emphasis>Properties file location</emphasis>
        <para>
            The wizard looks for the file in <emphasis>DATACLEANER_HOME</emphasis> directory. On Windows this
            can be: <emphasis>C:\Users\Username\.datacleaner\5.2.0\edp-wizard.properties</emphasis>.
            On Linux for example: <emphasis>/home/username/.datacleaner/5.2.0/edp-wizard.properties</emphasis>.
        </para>
        <para>
            You should find a sample of this properties file (<emphasis>edp-wizard.properties</emphasis>)
            in the program directory after the installation. Then you have to manually copy it to the required location
            (<emphasis>DATACLEANER_HOME</emphasis>). This required location will be created automatically,
            once you have started up DataCleaner for the first time.
        </para>

        <emphasis>Items</emphasis>
        <table frame='all'>
            <title>Properties</title>
            <tgroup cols='4' align='left' colsep='1' rowsep='1'>
                <colspec colname='c1'/>
                <colspec colname='c2'/>
                <colspec colname='c3'/>
                <colspec colname='c4'/>
                <colspec colnum='4' colname='c4'/>
                <thead>
                    <row>
                        <entry>Key</entry>
                        <entry>Example value</entry>
                        <entry>Required?</entry>
                        <entry>Meaning</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>edp.name.service.url</entry>
                        <entry>localhost:3180</entry>
                        <entry>yes</entry>
                        <entry>server for name and phone cleansing (typically Suite6 installation)</entry>
                    </row>
                    <row>
                        <entry>edp.architect.hostname</entry>
                        <entry>localhost</entry>
                        <entry>yes</entry>
                        <entry>server for address cleansing (Mailroom Toolkit aka Satori Architect)</entry>
                    </row>
                    <row>
                        <entry>edp.architect.port</entry>
                        <entry>5150</entry>
                        <entry>yes</entry>
                        <entry>port for address cleansing (Mailroom Toolkit aka Satori Architect)</entry>
                    </row>
                    <row>
                        <entry>edp.suppression.username</entry>
                        <entry>username</entry>
                        <entry>yes</entry>
                        <entry>credentials for additional suppression services</entry>
                    </row>
                    <row>
                        <entry>edp.suppression.password</entry>
                        <entry>password</entry>
                        <entry>yes</entry>
                        <entry>credentials for additional suppression services</entry>
                    </row>
                    <row>
                        <entry>edp.suppression.email</entry>
                        <entry>username@domain.com</entry>
                        <entry>yes</entry>
                        <entry>target e-mail for suppression services notifications</entry>
                    </row>
                    <row>
                        <entry>edp.outgoing.folder</entry>
                        <entry>C:\outgoing</entry>
                        <entry>no</entry>
                        <entry>directory for output data files (valid, invalid, samples)</entry>
                    </row>
                    <row>
                        <entry>edp.postalpresorting.defaulttemplatename</entry>
                        <entry>mailmark</entry>
                        <entry>no</entry>
                        <entry>template for presorting service</entry>
                    </row>
                    <row>
                        <entry>edp.postalpresorting.defaultfilesfolder</entry>
                        <entry>C:\presorting</entry>
                        <entry>no</entry>
                        <entry>directory for presorting service output (PDF report)</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>

        <emphasis>DataCleaner Monitor setup</emphasis>
        <para>
            In order to use <emphasis>hot folder functionality</emphasis>
            (see <link linkend="monitor_scheduling_jobs">Scheduling jobs</link> section for details)
            you have to configure DataCleaner Monitor connection first. After you deploy the war file and have it
            running in your browser
            (see <link linkend="installing_datacleaner_monitor">DataCleaner Monitor</link> for details),
            go to <emphasis>More/DataCleaner monitor</emphasis> menu item.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-monitor-setup-menu.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>

            Then fill in the following form, test the connection and save it.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-monitor-setup-dialog.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>
    </section>

    <section id="edp_wizard_datastores">
        <title>Datastores</title>
        <emphasis>Supported formats</emphasis>
        <para>
            For <emphasis>hot folder functionality</emphasis> Express Data Prep Wizard supports
            CSV (comma separated value) and Excel data files. You need to provide
            one within the wizard so that desired format (header) can be recognized. No real data is
            required to be in this file. Just column names.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-datastore-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>
        <para>
            Later on, when you upload your data files to the incoming hot folder, all those files have to follow
            exactly the same format (header). Otherwise the job execution fails.
        </para>
        <para>
            If you do not need to use <emphasis>hot folder functionality</emphasis> many other data formats/sources
            can be used. See <link linkend="connecting_to_your_datastore">Connecting to your datastore</link> and/or
            <link linkend="edp_wizard_input_output">Express Data Prep Wizzard -- Input&amp;output</link> sections
            for more details.
        </para>
    </section>

    <section id="edp_wizard_input_output">
        <title>Input&amp;output</title>
        <emphasis>Incoming hot folder</emphasis>
        <para>
            In the final phase of the wizard, when you decide to upload the job to DataCleaner Monitor, you can specify
            a directory that will be treated as <emphasis>incoming hot folder</emphasis>. This directory will be then
            regularly scanned for changes. Whenever such a change occurs, new/changed file will be considered as
            a new data input. That will trigger the job execution and process the data.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-upload.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>
        <para>
            It is important to keep the file format (header) that is required by the job. Incorrect
            file format will be recognized and reported within a failed job execution.
        </para>

        <emphasis>Outgoing folders</emphasis>
        <para>
            On the <link linkend="service_settings_page">Service settings page</link> you can specify
            <emphasis>outgoing folder path</emphasis> and <emphasis>outgoing presorting reports path</emphasis>. Both
            of these directories will serve as target directory where final output files will be put.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-services-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>
    </section>

    <section id="edp_wizard_use_case">
        <title>Typical use case</title>

        <emphasis>DataCleaner Desktop</emphasis>
        <para>
            After you start DataCleaner Desktop, you will see a welcome page. It can contain multiple wizards,
            select <emphasis>How can I effectively communicate with customers?</emphasis>.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-welcome-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>Datastore selection</emphasis>
        <para>
            On the next page you will be asked to provide a datastore.
            See <link linkend="edp_wizard_datastores">datastores</link> for details.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-datastore-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>Input mapping</emphasis>
        <para>
            After you provide input data file (datastore), its column names will be shown so that you can
            map those columns to their meanings. <emphasis>Address line</emphasis> and <emphasis>Postal code</emphasis>
            are required items.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-mapping-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis id="service_settings_page">Services settings</emphasis>
        <para>
            On the next page you can select which additional address services should be enabled. By default
            all of them are checked. You can also specify output directories where the final result files will
            be stored.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-services-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>Suppression settings</emphasis>
        <para>
            On this page you can configure which records will be sent to final <emphasis>mailing</emphasis>
            service. You can for example decide that all potential problems with e-mail and phone values should
            be ignored as long as address data is fine. You can also specify to leave out the records that do not
            contain any value in particular column.
        </para>
        <para>
            Records that have no errors or only acceptable errors go to a <emphasis>valid</emphasis> output file.
            Records that have non-acceptable errors go to a <emphasis>invalid</emphasis> output file.
            User can for example accept errors in persons names as long as the address is correct.
            Note that the <emphasis>valid</emphasis> output file includes the Name correction traffic lights,
            so user can still have a look on dubious/invalid names.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-suppression-settings-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>Output columns</emphasis>
        <para>
            This page provides you with all potential output columns that can be written to the final output files.
            Since there is a lot of them you can decide to leave intermediary and/or original columns out.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-output-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>What to do with the job?</emphasis>
        <para>
            This is the final wizard page where you can decide what to do with the job that has already been
            created. You can execute it right away, take a look at the job itself or upload it to DataCleaner Monitor.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-buttons-page.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>Job preview</emphasis>
        <para>
            When you decide to open the job, you will see something similar to this example. Here you can change
            any configuration you want and then execute the job.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-job.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <emphasis>Upload to DataCleaner Monitor</emphasis>
        <para>
            If you decide to upload the job to DataCleaner Monitor, an upload dialog will appear. Here you can edit
            pre-filled name of the job and specify <emphasis>incoming hot folder</emphasis> if desired. This path
            serves as an input directory where you can upload your data files to be automatically picked up and
            processed.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-upload.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
        </para>

        <para>
            On the following screenshot you can see the jobs listing in DataCleaner Monitor.
            <emphasis>Customer communication job 20170612 090930</emphasis> is the one that has been uploaded. Below
            the job name you can see <emphasis>schedule</emphasis> settings set to incoming hot folder.
            <mediaobject>
                <imageobject>
                    <imagedata fileref="edp-wizard-monitor-jobs.png" format="PNG" scalefit="1"/>
                </imageobject>
            </mediaobject>
            When you from now on put a new data file to that directory, job execution starts and output files are
            produced (they are available in configured output directories).
        </para>
    </section>
</chapter>
